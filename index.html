<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plataforma de Estudio - Abogacía</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #2D3748; --accent-color: #00D4FF; --background-color: #FFFFFF;
            --secondary-background: #F7FAFC; --text-color: #4A5568; --font-family: 'Poppins', sans-serif;
            --card-bg: #FFFFFF; --whatsapp-green: #25D366; --edit-blue: #3182CE; --delete-red: #E53E3E;
        }
        html { scroll-behavior: smooth; }
        body { font-family: var(--font-family); margin: 0; background-color: var(--background-color); color: var(--text-color); line-height: 1.7; }

        .header { position: fixed; top: 0; left: 0; width: 100%; z-index: 1000; display: flex; justify-content: space-between; align-items: center; padding: 1rem 2rem; background-color: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); box-shadow: 0 1px 3px rgba(0,0,0,0.05); box-sizing: border-box; }
        .logo { font-weight: 700; font-size: 1.25rem; color: var(--primary-color); text-decoration: none; }
        .main-nav a { margin: 0 1rem; color: var(--primary-color); text-decoration: none; font-weight: 600; font-size: 0.95rem; }

        .hero { display: flex; flex-direction: column; justify-content: center; align-items: center; min-height: 95vh; text-align: center; padding: 0 2rem; background-color: var(--secondary-background); }
        .hero h1 { font-size: 3.5rem; font-weight: 700; margin: 0; max-width: 800px; color: var(--primary-color); text-shadow: 0 4px 20px rgba(0,0,0,0.05); }
        .hero-cta { margin-top: 2rem; padding: 1rem 2.5rem; background-color: var(--accent-color); color: var(--primary-color); text-decoration: none; font-weight: 700; border-radius: 50px; transition: transform 0.2s, background-color 0.2s; }
        .hero-cta:hover { transform: translateY(-3px); background-color: #00eaff; }

        .info-section { padding: 4rem 2rem; max-width: 900px; margin: 0 auto; }
        .info-header { display: flex; justify-content: center; align-items: center; gap: 1rem; margin-bottom: 1.5rem; }
        .info-icon { width: 50px; height: 50px; background-color: var(--secondary-background); border-radius: 50%; display: flex; justify-content: center; align-items: center; color: var(--primary-color); }
        .info-icon svg { width: 24px; height: 24px; }
        .info-section h2 { text-align: left; font-size: 2.2rem; margin: 0; color: var(--primary-color); }
        .info-section p { font-size: 1.1rem; }
        
        .whatsapp-section, .contact-section { text-align: center; }
        .contact-section p { max-width: 650px; margin-left: auto; margin-right: auto; }
        .whatsapp-btn { display: inline-flex; align-items: center; gap: 10px; margin-top: 1.5rem; padding: 1rem 2.5rem; background-color: var(--whatsapp-green); color: white; text-decoration: none; font-weight: 700; border-radius: 50px; transition: transform 0.2s, background-color 0.2s; }
        .whatsapp-btn:hover { transform: translateY(-3px); background-color: #1DAE53; }
        .whatsapp-btn svg { width: 24px; height: 24px; fill: white; }
        .contact-links { display: flex; justify-content: center; gap: 2rem; margin-top: 2rem; flex-wrap: wrap; }
        
        #aviso-legal .info-header { justify-content: flex-start; }
        .card-container { background-color: var(--card-bg); border: 1px solid #E2E8F0; border-radius: 12px; padding: 2.5rem; }

        .clases-section { padding: 4rem 2rem; max-width: 1200px; margin: 0 auto; background-color: var(--secondary-background); }
        .clases-section h2 { text-align: center; font-size: 2.5rem; margin-bottom: 2rem; color: var(--primary-color); }
        #materias-nav { display: flex; flex-wrap: wrap; justify-content: center; gap: 1rem; margin-bottom: 2rem; }
        .materia-btn { background-color: var(--card-bg); border: 1px solid #ddd; padding: 0.75rem 1.5rem; cursor: pointer; border-radius: 50px; font-size: 1rem; font-weight: 600; transition: all 0.3s; }
        .materia-btn.active, .materia-btn:hover { background-color: var(--primary-color); color: white; border-color: var(--primary-color); }
        
        #actions-container { display: flex; justify-content: center; gap: 1rem; margin-bottom: 3rem; flex-wrap: wrap; }
        #actions-container .card-button { font-size: 0.9rem; padding: 0.7rem 1.2rem; }
        
        #content-container { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 1.5rem; }
        .content-card { background-color: var(--card-bg); border-radius: 12px; box-shadow: 0 5px 15px rgba(0,0,0,0.05); overflow: hidden; display: flex; flex-direction: column; transition: transform 0.3s, box-shadow 0.3s; }
        .content-card:hover { transform: translateY(-8px); box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        .card-header { padding: 1.5rem; display: flex; align-items: center; gap: 1rem; border-bottom: 1px solid #eee; }
        .card-icon { flex-shrink: 0; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; border-radius: 50%; }
        .card-icon.video { background-color: #E3F2FD; color: #1E88E5; } .card-icon.audio { background-color: #E8F5E9; color: #43A047; } .card-icon.pdf { background-color: #FFEBEE; color: #E53935; } .card-icon.summary { background-color: #FFF3E0; color: #FB8C00; }
        .card-icon svg { width: 24px; height: 24px; }
        .card-header h3 { margin: 0; font-size: 1.2rem; color: var(--primary-color); }
        .card-body { padding: 1.5rem; flex-grow: 1; display: flex; flex-direction: column; justify-content: center; gap: 0.75rem; }
        .card-button { width: 100%; padding: 0.75rem 1.5rem; text-align: center; background-color: var(--primary-color); color: white; text-decoration: none; font-weight: 600; border-radius: 8px; cursor: pointer; border: none; transition: background-color 0.2s; }
        .card-button:hover { background-color: #0E365C; }
        .card-actions { display: flex; gap: 0.5rem; width: 100%; }
        .action-btn { flex-grow: 1; border: none; background-color: var(--secondary-background); color: var(--text-color); font-weight: 600; padding: 0.5rem; border-radius: 6px; cursor: pointer; }
        .action-btn.edit { color: var(--edit-blue); } .action-btn.delete { color: var(--delete-red); }
        
        .modal { display: none; position: fixed; z-index: 2000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.8); justify-content: center; align-items: center; animation: fadeIn 0.3s; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .modal-content { background-color: var(--background-color); padding: 1.5rem; border-radius: 10px; width: 90%; max-width: 800px; position: relative; max-height: 90vh; display: flex; flex-direction: column; }
        .modal-header { display: flex; justify-content: space-between; align-items: flex-start; }
        .modal-header h2 { margin: 0; color: var(--primary-color); padding-right: 2.5rem; }
        #media-date { font-size: 0.9rem; color: #718096; margin: 0.25rem 0 1rem; }
        .close-button { position: absolute; top: 1rem; right: 1rem; background: none; border: none; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; display: flex; justify-content: center; align-items: center; font-size: 1.5rem; color: #aaa; transition: background-color 0.2s, color 0.2s; }
        .close-button:hover { background-color: #f0f0f0; color: var(--primary-color); }
        .modal-body { overflow-y: auto; flex-grow: 1; }
        #media-player-container { position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; background: #000; border-radius: 8px; }
        #media-player-container iframe, #pdf-viewer-container iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: none; }
        #pdf-viewer-container { height: 70vh; }
        
        #summary-editor-content input, #summary-editor-content div { width: 100%; padding: 0.75rem; font-size: 1rem; border-radius: 8px; border: 1px solid #ddd; box-sizing: border-box; }
        #summary-editor-content div { min-height: 200px; margin-top: 1rem; } #summary-editor-content input { margin-bottom: 1rem; }
        
        #exam-question { font-size: 1.3rem; font-weight: 600; color: var(--primary-color); margin-bottom: 1.5rem; }
        #exam-options label { display: block; background-color: var(--secondary-background); padding: 1rem; margin-bottom: 0.5rem; border-radius: 8px; cursor: pointer; transition: background-color 0.2s; }
        #exam-options label:hover { background-color: #E2E8F0; } #exam-options input[type="radio"] { margin-right: 10px; }
        .modal-footer { margin-top: 1.5rem; text-align: right; }
        
        #results-review li { list-style-type: none; margin-bottom: 1.5rem; padding: 1rem; border-radius: 8px; }
        #results-review li.correct { background-color: #C6F6D5; } #results-review li.incorrect { background-color: #FED7D7; }
        
        footer { text-align: center; padding: 2rem; background-color: var(--secondary-background); border-top: 1px solid #E2E8F0; }
        footer p { margin: 0.5rem 0; } footer a { color: var(--text-color); }

        @media (max-width: 768px) { .header { padding: 1rem; } .main-nav { display: none; } .hero h1 { font-size: 2.5rem; } .info-section h2 { font-size: 2rem; } }
    </style>
</head>
<body>

    <header class="header">
        <a href="#" class="logo">GuiaDerechoUDA</a>
        <nav class="main-nav">
            <a href="#about">El Proyecto</a>
            <a href="#clases">Material</a>
            <a href="#whatsapp">Comunidad</a>
            <a href="#contacto">Contacto</a>
        </nav>
    </header>

    <main>
        <section class="hero">
            <h1>Desbloquea tu potencial. Todo tu material de estudio en un solo lugar.</h1>
            <a href="#clases" class="hero-cta">Comenzar a estudiar</a>
        </section>
        
        <section id="about" class="info-section">
            <div class="info-header">
                <div class="info-icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C16.97 2 21 6.03 21 11C21 15.05 18.23 19.42 12.11 21.81C12.04 21.84 11.96 21.84 11.89 21.81C5.77 19.42 3 15.05 3 11C3 6.03 7.03 2 12 2Z"></path></svg></div>
                <h2>Nuestro Proyecto</h2>
            </div>
            <p>Esta plataforma nació de nuestra propia experiencia. Por eso, este proyecto fue <strong>pensado, ideado y creado por Ezequiel Ponce y Brisa Gimenez</strong>, y cuenta con el invaluable apoyo del <strong>Centro de Estudiantes</strong>.</p>
            <p>Nuestro propósito es ser un pilar de apoyo <strong>sin fines de lucro</strong>. Aquí encontrarás todo lo que necesitas: <strong>clases grabadas, audios, PDFs y resúmenes</strong>. Entendemos que empezar la carrera es un desafío. <strong>¡Estamos contigo!</strong></p>
        </section>

        <section id="whatsapp" class="info-section whatsapp-section">
            <div class="info-header">
                <div class="info-icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12.04 2C6.58 2 2.13 6.45 2.13 11.91C2.13 13.66 2.59 15.36 3.45 16.86L2.05 22L7.3 20.62C8.75 21.41 10.36 21.82 12.04 21.82C17.5 21.82 21.95 17.37 21.95 11.91C21.95 9.27 20.92 6.78 19.05 4.91C17.18 3.03 14.69 2 12.04 2Z"/></svg></div>
                <h2>Únete a Nuestra Comunidad</h2>
            </div>
            <p>Forma parte de nuestro grupo de WhatsApp para resolver dudas, coordinar estudios y recibir soporte sobre la plataforma.</p>
            <a href="URL_DEL_GRUPO_DE_WHATSAPP" class="whatsapp-btn" target="_blank" rel="noopener noreferrer">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12.04 2C6.58 2 2.13 6.45 2.13 11.91C2.13 13.66 2.59 15.36 3.45 16.86L2.05 22L7.3 20.62C8.75 21.41 10.36 21.82 12.04 21.82C17.5 21.82 21.95 17.37 21.95 11.91C21.95 9.27 20.92 6.78 19.05 4.91C17.18 3.03 14.69 2 12.04 2M12.04 3.67C16.56 3.67 20.28 7.39 20.28 11.91C20.28 16.43 16.56 20.15 12.04 20.15C10.56 20.15 9.14 19.78 7.9 19.09L7.54 18.89L4.45 19.75L5.33 16.72L5.12 16.36C4.35 15.08 3.8 13.53 3.8 11.91C3.8 7.39 7.52 3.67 12.04 3.67M9.13 7.5C8.91 7.5 8.7 7.57 8.51 7.78C8.31 7.99 7.81 8.52 7.81 9.73C7.81 10.94 8.51 12.11 8.63 12.29C8.75 12.47 10.28 14.92 12.72 15.93C14.78 16.78 15.19 16.63 15.65 16.58C16.11 16.53 17.14 15.96 17.35 15.35C17.56 14.74 17.56 14.23 17.44 14.11C17.32 13.99 17.14 13.92 16.88 13.78C16.63 13.64 15.37 13.02 15.12 12.93C14.87 12.83 14.7 12.78 14.53 13.04C14.36 13.3 13.86 13.92 13.72 14.08C13.57 14.24 13.42 14.27 13.17 14.15C12.92 14.03 11.91 13.7 10.72 12.64C9.77 11.82 9.17 10.85 9.02 10.59C8.87 10.33 8.98 10.19 9.1 10.07C9.22 9.95 9.37 9.77 9.51 9.61C9.65 9.45 9.7 9.34 9.8 9.17C9.9 9 9.85 8.84 9.78 8.7C9.71 8.56 9.35 7.5 9.13 7.5Z" /></svg>
                <span>Unirse al Grupo</span>
            </a>
        </section>

        <section id="clases" class="clases-section">
            <h2>Material de Estudio</h2>
            <nav id="materias-nav"></nav>
            <div id="actions-container"></div>
            <div id="content-container"></div>
        </section>
        
        <section id="contacto" class="info-section contact-section">
             <div class="info-header">
                <div class="info-icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M20 17.35V20H4V17.35C4 15.6 9.33 14 12 14S20 15.6 20 17.35M12 12C14.21 12 16 10.21 16 8S14.21 4 12 4 8 5.79 8 8 9.79 12 12 12Z"></path></svg></div>
                <h2>Contacto Directo</h2>
            </div>
            <p>Si tienes alguna duda o sugerencia, puedes enviarnos un WhatsApp.</p>
            <div class="contact-links">
                 <!-- IMPORTANTE: CAMBIA ESTOS NÚMEROS -->
                <a href="https://wa.me/5491234567890" class="whatsapp-btn" target="_blank" rel="noopener noreferrer">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12.04 2C6.58 2 2.13 6.45 2.13 11.91C2.13 13.66 2.59 15.36 3.45 16.86L2.05 22L7.3 20.62C8.75 21.41 10.36 21.82 12.04 21.82C17.5 21.82 21.95 17.37 21.95 11.91C21.95 9.27 20.92 6.78 19.05 4.91C17.18 3.03 14.69 2 12.04 2Z" /></svg>
                    <span>Contactar a Ezequiel</span>
                </a>
                <a href="https://wa.me/5491234567891" class="whatsapp-btn" target="_blank" rel="noopener noreferrer">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12.04 2C6.58 2 2.13 6.45 2.13 11.91C2.13 13.66 2.59 15.36 3.45 16.86L2.05 22L7.3 20.62C8.75 21.41 10.36 21.82 12.04 21.82C17.5 21.82 21.95 17.37 21.95 11.91C21.95 9.27 20.92 6.78 19.05 4.91C17.18 3.03 14.69 2 12.04 2Z" /></svg>
                    <span>Contactar a Brisa</span>
                </a>
            </div>
        </section>
        
        <section id="aviso-legal" class="info-section">
            <div class="card-container">
                <div class="info-header">
                    <div class="info-icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 1L3 5V11C3 16.55 6.84 21.74 12 23C17.16 21.74 21 16.55 21 11V5L12 1Z"></path></svg></div>
                    <h2>Aviso Legal</h2>
                </div>
                <p>Todo el material aquí disponible ha sido creado y compilado por los administradores y colaboradores con fines estrictamente educativos. Si usted es titular de los derechos de autor de algún material y considera que su uso infringe dichos derechos, por favor contáctenos para su pronta remoción.</p>
            </div>
        </section>
    </main>

    <!-- Modals -->
    <div id="media-player-modal" class="modal"><div class="modal-content"><div class="modal-header"><div><h2 id="media-title"></h2><p id="media-date"></p></div><button class="close-button">&times;</button></div><div class="modal-body"><div id="media-player-container"></div></div></div></div>
    <div id="pdf-viewer-modal" class="modal"><div class="modal-content"><div class="modal-header"><div><h2 id="pdf-title"></h2></div><button class="close-button">&times;</button></div><div class="modal-body"><div id="pdf-viewer-container"></div></div></div></div>
    <div id="summary-viewer-modal" class="modal"><div class="modal-content"><div class="modal-header"><h2 id="summary-title"></h2><button class="close-button">&times;</button></div><div class="modal-body" id="summary-viewer-content"></div></div></div>
    <div id="summary-editor-modal" class="modal"><div class="modal-content"><div class="modal-header"><h2>Crear Resumen</h2><button class="close-button">&times;</button></div><div class="modal-body" id="summary-editor-content"><input type="text" id="summary-editor-title" placeholder="Título de tu resumen..."><div id="summary-editor" contenteditable="true"></div><button class="card-button" id="save-summary-btn" style="margin-top: 1rem;">Guardar Resumen</button></div></div></div>
    <div id="exam-modal" class="modal"><div class="modal-content"><div class="modal-header"><h2 id="exam-title"></h2><span id="exam-progress"></span><button class="close-button">&times;</button></div><div class="modal-body"><div id="exam-question"></div><div id="exam-options"></div></div><div class="modal-footer"><button id="exam-next-btn" class="card-button">Siguiente</button></div></div></div>
    <div id="exam-results-modal" class="modal"><div class="modal-content"><div class="modal-header"><h2>Resultados</h2><button class="close-button">&times;</button></div><div class="modal-body"><h3 id="results-score"></h3><ul id="results-review"></ul></div></div></div>
    <div id="info-modal" class="modal"><div class="modal-content"><div class="modal-header"><h2 id="info-title"></h2><button class="close-button">&times;</button></div><div class="modal-body" id="info-content"></div></div></div>
    
    <footer>
        <p>&copy; 2025 Plataforma de Apoyo Estudiantil. Todos los derechos reservados.</p>
        <p><a href="#aviso-legal">Aviso Legal y de Derechos de Autor</a></p>
    </footer>

    <script src="https://www.youtube.com/iframe_api"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            
            let masterContent = {
                'Derecho Penal I (Parte General)': {
                    recursos: [ 
                        { type: 'video', id: 'yd12z-uJ-mc', title: 'Clase completa (04-08-2025)', fecha: '4 de Agosto, 2025' },
                        { type: 'video', id: 'Y_Mapuzy7I0', title: 'Clase completa (06-08-2025)', fecha: '6 de Agosto, 2025' },
                        { type: 'pdf', url: 'https://estudioabogacia.dev.ar/pdf/05-%20Derecho%20Penal%20I%20(Parte%20General)%202025.pdf', title: 'Programa' }
                    ],
                    examen: [], 
                    fechasParciales: "Primer Parcial: Aún no disponible.<br>Segundo Parcial: Aún no disponible.",
                    trabajosPracticos: [] 
                },
                'Derecho Público I (Constitucional)': { 
                    recursos: [
                        { type: 'video', id: 'jej_fSNhavI', title: 'Clase completa (04-08-2025)', fecha: '4 de Agosto, 2025' },
                        { type: 'video', id: 'xQPwUH3W79Q', title: 'Clase completa (05-08-2025)', fecha: '5 de Agosto, 2025' },
                        { type: 'pdf', url: 'https://estudioabogacia.dev.ar/pdf/06-%20Derecho%20Pu%CC%81blico%20I%20(Constitucional).pdf', title: 'Programa' }
                    ],
                    fechasParciales: "Aún no disponible.",
                    trabajosPracticos: [
                        { title: 'TP N°1 - Las Fuentes del Derecho', url: 'URL_AL_PDF_DEL_TP1' }
                    ]
                }
            };

            const elems = {
                materiasNav: document.getElementById('materias-nav'), contentContainer: document.getElementById('content-container'), actionsContainer: document.getElementById('actions-container'),
                mediaModal: document.getElementById('media-player-modal'), mediaTitle: document.getElementById('media-title'), mediaDate: document.getElementById('media-date'), mediaPlayerContainer: document.getElementById('media-player-container'),
                pdfModal: document.getElementById('pdf-viewer-modal'), pdfTitle: document.getElementById('pdf-title'), pdfViewerContainer: document.getElementById('pdf-viewer-container'),
                summaryViewerModal: document.getElementById('summary-viewer-modal'), summaryTitle: document.getElementById('summary-title'), summaryViewerContent: document.getElementById('summary-viewer-content'),
                summaryEditorModal: document.getElementById('summary-editor-modal'), summaryEditorTitle: document.getElementById('summary-editor-title'), summaryEditor: document.getElementById('summary-editor'),
                examModal: document.getElementById('exam-modal'), examTitle: document.getElementById('exam-title'), examProgress: document.getElementById('exam-progress'), examQuestion: document.getElementById('exam-question'), examOptions: document.getElementById('exam-options'), examNextBtn: document.getElementById('exam-next-btn'),
                resultsModal: document.getElementById('exam-results-modal'), resultsScore: document.getElementById('results-score'), resultsReview: document.getElementById('results-review'),
                infoModal: document.getElementById('info-modal'), infoTitle: document.getElementById('info-title'), infoContent: document.getElementById('info-content'),
                saveSummaryBtn: document.getElementById('save-summary-btn')
            };

            let ytPlayer, currentMateria;
            const icons = {
                video: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M17,10.5V7A1,1,0,0,0,16,6H4A1,1,0,0,0,3,7V17A1,1,0,0,0,4,18H16A1,1,0,0,0,17,17V13.5L21,17.5V6.5Z"></path></svg>`,
                audio: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12,3V13.55A4,4,0,1,0,14,17V7H18V3H12Z"></path></svg>`,
                pdf: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M19,20C19,21.1,18.1,22,17,22H7C5.9,22,5,21.1,5,20V4C5,2.9,5.9,2,7,2H12V9H19V20M14,2H14.5L19.5,7H19V7.5H14V2Z"></path></svg>`,
                summary: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M14 17H7V15H14V17M17 13H7V11H17V13M17 9H7V7H17V9M19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 19.1 21 19V5C21 3.9 20.1 3 19 3Z"></path></svg>`
            };
            
            function loadUserSummaries() {
                const userSummaries = JSON.parse(localStorage.getItem('userSummaries')) || {};
                for (const materia in userSummaries) {
                    if (masterContent[materia]) {
                        if (!masterContent[materia].recursos) masterContent[materia].recursos = [];
                        masterContent[materia].recursos.push(...userSummaries[materia]);
                    }
                }
            }

            function init() { loadUserSummaries(); setupEventListeners(); loadMaterias(); if (elems.materiasNav.firstChild) elems.materiasNav.firstChild.click(); }
            function loadMaterias() { for (const materia in masterContent) { const btn = document.createElement('button'); btn.className = 'materia-btn'; btn.textContent = materia; btn.dataset.materia = materia; elems.materiasNav.appendChild(btn); } }
            function setActiveMateria(materia) { currentMateria = materia; document.querySelectorAll('.materia-btn').forEach(b => b.classList.toggle('active', b.dataset.materia === materia)); setupActionButtons(materia); loadContent(materia); }

            function setupActionButtons(materia) {
                elems.actionsContainer.innerHTML = '';
                const materiaData = masterContent[materia] || {};
                const datesBtn = document.createElement('button'); datesBtn.className = 'card-button'; datesBtn.textContent = 'Fechas de Parciales';
                datesBtn.onclick = () => showInfoModal('Fechas de Parciales', `<p>${materiaData.fechasParciales || "No disponible aún."}</p>`);
                elems.actionsContainer.appendChild(datesBtn);
                const tpBtn = document.createElement('button'); tpBtn.className = 'card-button'; tpBtn.textContent = 'Trabajos Prácticos';
                tpBtn.onclick = () => { let contentHTML = (materiaData.trabajosPracticos && materiaData.trabajosPracticos.length > 0) ? `<ul>${materiaData.trabajosPracticos.map(tp => `<li><a href="${tp.url}" target="_blank">${tp.title}</a></li>`).join('')}</ul>` : '<p>Aún no disponible.</p>'; showInfoModal('Trabajos Prácticos Hechos', contentHTML); };
                elems.actionsContainer.appendChild(tpBtn);
                const summaryBtn = document.createElement('button');
                summaryBtn.className = 'card-button'; summaryBtn.style.backgroundColor = 'var(--accent-color)'; summaryBtn.style.color = 'var(--primary-color)';
                summaryBtn.textContent = '+ Crear Resumen'; summaryBtn.onclick = () => openModal(elems.summaryEditorModal);
                elems.actionsContainer.appendChild(summaryBtn);
                const examBtn = document.createElement('button');
                examBtn.className = 'card-button'; examBtn.style.backgroundColor = 'var(--primary-color)';
                examBtn.textContent = 'Simular Parcial';
                examBtn.onclick = () => { (materiaData.examen && materiaData.examen.length > 0) ? startExam(materia) : showInfoModal('Simular Parcial', '<p>No disponible aún.</p>'); };
                elems.actionsContainer.appendChild(examBtn);
            }
            
            function loadContent(materia) {
                elems.contentContainer.innerHTML = ''; const resources = masterContent[materia]?.recursos || [];
                resources.forEach(item => {
                    const card = document.createElement('div'); card.className = 'content-card';
                    let actionsHTML = '';
                    if(item.type === 'summary'){ actionsHTML = `<div class="card-actions"><button class="action-btn edit">Editar</button><button class="action-btn delete">Borrar</button></div>`; }
                    card.innerHTML = `<div class="card-header"><div class="card-icon ${item.type}">${icons[item.type]}</div><h3>${item.title}</h3></div><div class="card-body"><button class="card-button">Abrir Material</button>${actionsHTML}</div>`;
                    card.querySelector('.card-button').addEventListener('click', () => openResource(item));
                    if(item.type === 'summary'){
                        card.querySelector('.edit').addEventListener('click', (e) => { e.stopPropagation(); editSummary(item); });
                        card.querySelector('.delete').addEventListener('click', (e) => { e.stopPropagation(); deleteSummary(item); });
                    }
                    elems.contentContainer.appendChild(card);
                });
            }
            
            function openResource(data) { /* ...código sin cambios... */ }
            function editSummary(summaryData) { /* ...código sin cambios... */ }
            function deleteSummary(summaryData) { /* ...código sin cambios... */ }
            function saveSummary() { /* ...código sin cambios... */ }
            function showInfoModal(title, contentHTML) { elems.infoTitle.textContent = title; elems.infoContent.innerHTML = contentHTML; openModal(elems.infoModal); }
            function openModal(modalElement) { modalElement.style.display = 'flex'; }
            function closeModal(modalElement) {
                if (modalElement === elems.mediaModal && ytPlayer && typeof ytPlayer.stopVideo === 'function') ytPlayer.stopVideo();
                if (modalElement === elems.summaryEditorModal) delete elems.saveSummaryBtn.dataset.editingId;
                if (modalElement === elems.pdfModal) elems.pdfViewerContainer.innerHTML = '';
                modalElement.style.display = 'none';
            }
            function setupEventListeners() {
                elems.materiasNav.addEventListener('click', (e) => { if (e.target.classList.contains('materia-btn')) setActiveMateria(e.target.dataset.materia); });
                document.querySelectorAll('.modal .close-button').forEach(btn => btn.onclick = () => closeModal(btn.closest('.modal')));
                window.onclick = (event) => { if (event.target.classList.contains('modal')) closeModal(event.target); };
                window.onkeydown = (event) => { if (event.key === 'Escape') document.querySelectorAll('.modal').forEach(m => closeModal(m)); };
                elems.saveSummaryBtn.addEventListener('click', saveSummary);
                elems.examNextBtn.addEventListener('click', handleNextQuestion);
            }

            function startExam(materia){currentExamQuestions=masterContent[materia].examen;currentQuestionIndex=0;userAnswers=[];elems.examTitle.textContent=`Examen: ${materia}`;displayQuestion();openModal(elems.examModal)}
            function displayQuestion(){const e=currentExamQuestions[currentQuestionIndex];elems.examProgress.textContent=`Pregunta ${currentQuestionIndex+1} de ${currentExamQuestions.length}`;elems.examQuestion.textContent=e.pregunta;elems.examOptions.innerHTML="";e.opciones.forEach((t,n)=>{elems.examOptions.innerHTML+=`<label><input type="radio" name="option" value="${n}"> ${t}</label>`});elems.examNextBtn.textContent=currentQuestionIndex===currentExamQuestions.length-1?"Ver Resultados":"Siguiente"}
            function handleNextQuestion(){const e=document.querySelector('input[name="option"]:checked');if(!e)return void alert("Por favor, selecciona una opción.");userAnswers.push(parseInt(e.value));currentQuestionIndex++;if(currentQuestionIndex<currentExamQuestions.length)displayQuestion();else showResults()}
            function showResults(){closeModal(elems.examModal);let e=0;elems.resultsReview.innerHTML="";currentExamQuestions.forEach((t,n)=>{const o=userAnswers[n]===t.correcta;o&&e++;elems.resultsReview.innerHTML+=`<li class="${o?"correct":"incorrect"}"><strong>${t.pregunta}</strong><br>Tu respuesta: ${t.opciones[userAnswers[n]]}<br>Respuesta correcta: ${t.opciones[t.correcta]}</li>`});const t=Math.round(e/currentExamQuestions.length*100);elems.resultsScore.textContent=`Tu Puntuación: ${t}% (${e} de ${currentExamQuestions.length} correctas)`;openModal(elems.resultsModal)}
            function openResource(data){let e;switch(data.type){case"video":case"audio":e=elems.mediaModal,elems.mediaTitle.textContent=data.title,elems.mediaDate.textContent=data.fecha||"",data.type==="video"?(elems.mediaPlayerContainer.innerHTML='<div id="youtube-player"></div>',ytPlayer=new YT.Player("youtube-player",{height:"100%",width:"100%",videoId:data.id,playerVars:{autoplay:1,rel:0}})):elems.mediaPlayerContainer.innerHTML=`<iframe src="${data.url}" allow="autoplay"></iframe>`;break;case"pdf":e=elems.pdfModal,elems.pdfTitle.textContent=data.title,elems.pdfViewerContainer.innerHTML=`<iframe src="${data.url}"></iframe>`;break;case"summary":e=elems.summaryViewerModal,elems.summaryTitle.textContent=data.title,elems.summaryViewerContent.innerHTML=data.content}e&&openModal(e)}
            function editSummary(summaryData){openModal(elems.summaryEditorModal);elems.summaryEditorTitle.value=summaryData.title;elems.summaryEditor.innerHTML=summaryData.content;elems.saveSummaryBtn.dataset.editingId=summaryData.id}
            function deleteSummary(summaryData){if(!confirm(`¿Estás seguro de que quieres borrar el resumen "${summaryData.title}"?`))return;const e=JSON.parse(localStorage.getItem("userSummaries"))||{};e[currentMateria]&&(e[currentMateria]=e[currentMateria].filter(e=>e.id!==summaryData.id),localStorage.setItem("userSummaries",JSON.stringify(e)));masterContent[currentMateria]&&masterContent[currentMateria].recursos&&(masterContent[currentMateria].recursos=masterContent[currentMateria].recursos.filter(e=>e.id!==summaryData.id));loadContent(currentMateria)}
            function saveSummary(){const e=elems.summaryEditorTitle.value.trim(),t=elems.summaryEditor.innerHTML.trim();if(!e||!t)return void alert("Por favor, completa el título y el contenido.");const n=elems.saveSummaryBtn.dataset.editingId,o=JSON.parse(localStorage.getItem("userSummaries"))||{};o[currentMateria]||(o[currentMateria]=[]);if(n){const a=o[currentMateria].findIndex(e=>e.id==n);a>-1&&(o[currentMateria][a].title=e,o[currentMateria][a].content=t)}else{const a={id:Date.now(),type:"summary",title:e,content:t,fecha:(new Date).toLocaleDateString("es-ES",{day:"numeric",month:"long",year:"numeric"})};o[currentMateria].push(a)}localStorage.setItem("userSummaries",JSON.stringify(o));location.reload()}

            init();
        });
    </script>
</body>
</html>
